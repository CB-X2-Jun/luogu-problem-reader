# P2730 P2730 [IOI 1996 / USACO3.2] 魔板 Magic Squares

## 题目背景

在成功地发明了魔方之后，鲁比克先生发明了它的二维版本，称作魔板。我们知道魔板的每一个方格都有一种颜色。这 $8$ 种颜色用前 $8$ 个正整数来表示。可以用颜色的序列来表示一种魔板状态，规定从魔板的左上角开始，沿顺时针方向依次取出整数，构成一个颜色序列。

## 题目描述

这是一张有 $8$ 个大小相同的格子的魔板：
| $1$ | $2$ | $3$ | $4$ |
|:-:|:-:|:-:|:-:|
| $8$ | $7$ | $6$ | $5$ |

对于上图的魔板状态，我们用序列 $\{1,2,3,4,5,6,7,8\}$ 来表示。这是基本状态。

这里提供三种基本操作，分别用大写字母 $\text A$、$\text B$、$\text C$ 来表示（可以通过这些操作改变魔板的状态）。下面是对基本状态进行操作的示范：

$\text A$：交换上下两行；
| $8$ | $7$ | $6$ | $5$ |
|:-:|:-:|:-:|:-:|
| $1$ | $2$ | $3$ | $4$ |

$\text B$：将最右边的一列插入最左边；
| $4$ | $1$ | $2$ | $3$ |
|:-:|:-:|:-:|:-:|
| $5$ | $8$ | $7$ | $6$ |

$\text C$：魔板中央四格作顺时针旋转。
| $1$ | $7$ | $2$ | $4$ |
|:-:|:-:|:-:|:-:|
| $8$ | $6$ | $3$ | $5$ |

对于转换过程中任意一个状态，这三种基本操作都可以使用。

编程计算最短的基本操作序列，完成基本状态到目标状态的转换。

## 输入格式

只有一行，包括 $8$ 个整数 $a_1,a_2\dots,a_8\ (1\leq a_1,a_2,\dots,a_8\leq8)$，用空格分开（中间无换行），表示目标状态。

## 输出格式

第一行包括一个整数，表示最短操作序列的长度。

第二行开始输出最短的操作序列，用字符串表示，每 $60$ 个字符换一行。如果有多种，输出字典序最小的。

## 输入输出样例

### 样例 #1

#### 样例输入 #1

```
2 6 8 4 5 7 3 1
```

#### 样例输出 #1

```
7 
BCABCCB
```

## 说明/提示

题目翻译来自 NOCOW。
