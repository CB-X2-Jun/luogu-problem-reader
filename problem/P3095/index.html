<!doctype html>
<html lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="æ´›è°·é¢˜ç›®æµè§ˆç«™é¢˜ç›®è¯¦æƒ…">
    <meta name="author" content="CB_X2_Jun">
    <link rel="canonical" href="https://lglg.netlify.app/problem/P3095/">
    <link rel="icon" href="../../assets/images/favicon.png">
    <meta name="generator" content="mkdocs-material">
    <title>P3095 [USACO13DEC] The Bessie Shuffle S</title>
    <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
    <style>
      :root { --md-text-font: "Roboto"; --md-code-font: "Roboto Mono" }
      
      /* ç¾åŒ–é¢˜ç›®é¡µé¢æ ·å¼ */
      .md-content__inner {
        max-width: 1000px;
        margin: 0 auto;
      }
      
      /* é¢˜ç›®æ ‡é¢˜ç¾åŒ– */
      .md-content__inner h1 {
        color: #2c3e50;
        font-size: 2.5rem;
        font-weight: bold;
        margin-bottom: 2rem;
        text-align: center;
        padding: 1rem 0;
        border-bottom: 3px solid #3498db;
      }
      
      /* é¢˜ç›®å†…å®¹åŒºå—ç¾åŒ– */
      .md-content__inner h2 {
        background: #f8f9fa;
        color: #2c3e50;
        padding: 1rem 1.5rem;
        border-radius: 8px;
        border-left: 4px solid #3498db;
        margin: 2rem 0 1rem 0;
        font-size: 1.3rem;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        font-weight: 600;
      }
      
      /* ä»£ç å—ç¾åŒ– */
      .md-content__inner pre {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 1.5rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        margin: 1.5rem 0;
      }
      
      .md-content__inner pre code {
        background: transparent;
        color: #2c3e50;
        padding: 0;
        border-radius: 0;
        font-weight: 400;
      }
      
      .md-content__inner code {
        background: #e9ecef;
        color: #495057;
        padding: 0.2rem 0.5rem;
        border-radius: 4px;
        font-weight: 500;
      }
      
      /* æ ·ä¾‹åŒºå—ç‰¹æ®Šç¾åŒ– */
      .md-content__inner h3:contains("æ ·ä¾‹") {
        background: #f0f8ff;
        color: #2c3e50;
        padding: 0.8rem 1.2rem;
        border-radius: 6px;
        border-left: 4px solid #17a2b8;
        margin: 1.5rem 0 0.8rem 0;
        font-size: 1.1rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        font-weight: 600;
      }
      
      /* æ™®é€šæ®µè½ç¾åŒ– */
      .md-content__inner p {
        line-height: 1.8;
        margin: 1rem 0;
        color: #444;
      }
      
      /* åˆ—è¡¨ç¾åŒ– */
      .md-content__inner ul, .md-content__inner ol {
        padding-left: 2rem;
        margin: 1rem 0;
      }
      
      .md-content__inner li {
        margin: 0.5rem 0;
        line-height: 1.6;
      }
      
      /* è¡¨æ ¼ç¾åŒ– */
      .md-content__inner table {
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        margin: 1.5rem 0;
      }
      
      .md-content__inner th {
        background: #e9ecef;
        color: #495057;
        font-weight: 600;
      }
      
      /* è¿”å›æŒ‰é’®ç¾åŒ– */
      .back-button {
        display: inline-block;
        background: #3498db;
        color: white;
        padding: 0.8rem 1.5rem;
        border-radius: 8px;
        text-decoration: none;
        font-weight: bold;
        margin: 2rem 0;
        transition: background-color 0.3s;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      
      .back-button:hover {
        background: #2980b9;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        color: white;
        text-decoration: none;
      }
      
      /* Giscusè¯„è®ºåŒºåŸŸæ ·å¼ */
      .comments-section {
        margin: 3rem 0 2rem 0;
        padding: 2rem;
        background: #f8f9fa;
        border-radius: 12px;
        border: 1px solid #e9ecef;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      }
      
      .comments-title {
        color: #2c3e50;
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid #3498db;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      
      /* è‡ªå®šä¹‰Giscusæ ·å¼ */
      .giscus {
        margin-top: 1rem;
      }
      
      .giscus-frame {
        border-radius: 8px;
        border: 1px solid #e9ecef;
      }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github.min.css">
  </head>
  <body dir="ltr">
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      <a href="#é¢˜ç›®å†…å®¹" class="md-skip">è·³è½¬è‡³</a>
    </div>
    <div data-md-component="announce"></div>
    
    <div id="__config" data-md-config="{&quot;base&quot;:&quot;../..&quot;,&quot;features&quot;:[],&quot;search&quot;:{&quot;worker&quot;:&quot;assets/javascripts/workers/search.b8dbb3d2.min.js&quot;}}"></div>
    
    <header class="md-header md-header--shadow" data-md-component="header">
      <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
        <a href="/" title="æ´›è°·é¢˜ç›®æµè§ˆç«™" class="md-header__button md-logo" aria-label="æ´›è°·é¢˜ç›®æµè§ˆç«™" data-md-component="logo">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
        </a>
        <label class="md-header__button md-icon" for="__drawer">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
        </label>
        <div class="md-header__title" data-md-component="header-title">
          <div class="md-header__ellipsis">
            <div class="md-header__topic">
              <span class="md-ellipsis">æ´›è°·é¢˜ç›®æµè§ˆç«™</span>
            </div>
            <div class="md-header__topic" data-md-component="header-topic">
              <span class="md-ellipsis">P3095 [USACO13DEC] The Bessie Shuffle S</span>
            </div>
          </div>
        </div>
      </nav>
    </header>
    <div class="md-container" data-md-component="container">
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          <!-- ä¾§è¾¹æ å¯¼èˆª -->
          <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" aria-label="å¯¼èˆªæ " data-md-level="0">
                  <label class="md-nav__title" for="__drawer">
                    <a href="/" title="æ´›è°·é¢˜ç›®æµè§ˆç«™" class="md-nav__button md-logo" aria-label="æ´›è°·é¢˜ç›®æµè§ˆç«™" data-md-component="logo">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
                    </a>
                    æ´›è°·é¢˜ç›®æµè§ˆç«™
                  </label>
                  <ul class="md-nav__list" data-md-scrollfix>
                    <li class="md-nav__item">
                      <a href="/" class="md-nav__link">
                        <span class="md-ellipsis">ğŸ  é¦–é¡µ</span>
                      </a>
                    </li>
                    <li class="md-nav__item">
                      <a href="/problem/list/" class="md-nav__link">
                        <span class="md-ellipsis">ğŸ“‹ é¢˜ç›®åˆ—è¡¨</span>
                      </a>
                    </li>
                    <li class="md-nav__item">
                      <a href="/about/" class="md-nav__link">
                        <span class="md-ellipsis">â„¹ï¸ å…³äº</span>
                      </a>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              <h2 id="_1">é¢˜ç›®æè¿°</h2>
<p>Bessie is practicing her card tricks.  She has already mastered the Bessie- shuffle -- a shuffle on M (2 &lt;= M &lt;= 100,000) cards that reorganizes the cards so the i-th card from the top is now the P[i]-th card from the top.</p>
<p>Now Bessie is practicing shuffles on larger decks.  She has a deck of N cards (M &lt;= N &lt;= 100,000) conveniently labeled 1 to N.  She shuffles this deck by taking the first M cards and performing the Bessie-shuffle on them, placing the shuffled cards back on top of the deck.  She then removes the top card from the deck and places it face down.  She repeats this process, placing the top cards successively on top of each other, until she is out of cards.  When Bessie has less than M cards left, she no longer performs the Bessie-shuffle, but continues to place the top card on top of the others.</p>
<p>Bessie knows that the deck initially started in sorted order, with 1 on top, 2 next, and N on the bottom.  Given the description of the Bessie-shuffle, help Bessie compute which cards end up located at Q different specified positions (1 &lt;= Q &lt;= N, Q &lt;= 5,000) in the deck.</p>
<p>è´è¥¿æœ‰ä¸€ç§ç‹¬é—¨çš„æ´—ç‰Œæ–¹æ³•ï¼Œç§°ä¸º A ç±»æ´—ç‰Œæ³•ï¼›</p>
<p>A ç±»æ´—ç‰Œæ³•çš„å…·ä½“è¿‡ç¨‹ï¼šå°†ä¸€å †å…± $M$ï¼ˆ$2 \le M \le 10 ^ 5$ï¼‰å¼ ä»ä¸Šåˆ°ä¸‹ç¼–å· $1, 2, \cdots, M$ çš„çº¸ç‰Œï¼Œä»ä¸Šåˆ°ä¸‹ç¬¬ $i$ å¼ ç‰Œæ´—åˆ°ä½ç½® $p _ i$ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ$M=3ï¼Œp = {3, 1, 2}$ï¼Œåˆ™æ‰§è¡Œä¸€æ¬¡ A ç±»æ´—ç‰Œæ³•åï¼Œä»ä¸Šåˆ°ä¸‹å°†å˜ä¸º $2, 3, 1$ï¼Œå³ç‰Œ $1$ æ”¾åˆ°ä½ç½® $3$ï¼Œç‰Œ $2$ æ”¾åˆ°ä½ç½® $1$ï¼Œç‰Œ $3$ æ”¾åˆ°ä½ç½® $2$ã€‚</p>
<p>è´è¥¿ç°åœ¨è¦ç»ƒä¹ å¦å¤–ä¸€ç§æ´—ç‰Œæ–¹æ³•ï¼Œç§°ä¸º B ç±»æ´—ç‰Œæ³•ã€‚</p>
<p>B ç±»æ´—ç‰Œæ³•çš„å…·ä½“è¿‡ç¨‹ï¼š </p>
<p>æœ‰ä¸€å † $N$ï¼ˆ$M \le N \le 10 ^ 5$ï¼‰å¼ ç¼–å·ä¸º $1, 2, \cdots, N$ çš„ç‰Œï¼Œå¹¶æŒ‰ä»ä¸Šåˆ°ä¸‹ $1$ åˆ° $N$ çš„é¡ºåºå †æ”¾ã€‚å¦æœ‰ä¸€ä¸ªç‰Œå †ç”¨æ¥è¾…åŠ©æ´—ç‰Œï¼Œç§°ä¸ºä¸´æ—¶å †ï¼Œå¼€å§‹æ—¶ä¸ºç©ºã€‚</p>
<ol>
<li>å°†æœ€ä¸Šé¢ $M$ å¼ ç‰Œè¿›è¡Œä¸€æ¬¡ A ç±»æ´—ç‰Œæ³•ï¼›</li>
<li>å°†æœ€ä¸Šé¢çš„ä¸€å¼ ç‰Œæ”¾åˆ°ä¸´æ—¶å †çš„æœ€ä¸Šæ–¹ï¼›</li>
<li>é‡å¤å‰ä¸¤ä¸ªæ“ä½œï¼Œç›´åˆ°åŸå…ˆçš„å †æ²¡æœ‰ç‰Œä¸ºæ­¢ã€‚</li>
</ol>
<p>ä»¥ä¸Šè¿‡ç¨‹ä¸­ï¼Œå½“åŸå…ˆå †çš„ç‰Œä¸è¶³ $M$ å¼ çš„æ—¶å€™ï¼Œå°†ä¸è¿›è¡Œ A ç±»æ´—ç‰Œæ³•ï¼Œè€Œæ˜¯å°†æœ€ä¸Šé¢çš„ç‰Œä¾æ¬¡æ”¾åˆ°ä¸´æ—¶å †ä¸Šã€‚</p>
<p>ç»™å®š $N, M$ å’Œæ’åˆ— $p$ã€‚ç°åœ¨æœ‰ $Q$ï¼ˆ$1 \le Q \le \min(N, 5000)$ï¼‰ä¸ªè¯¢é—®ï¼Œè¯·æ±‚å‡ºå¯¹å…¶åšä¸€æ¬¡ B ç±»æ´—ç‰Œæ³•åä¸´æ—¶å †ä¸­ $q _ i$ ä½ç½®ä¸Šçš„ç‰Œçš„ç¼–å·ã€‚</p>
<h2 id="_2">è¾“å…¥æ ¼å¼</h2>
<p>* Line 1: A single line containing N, M and Q separated by a space.</p>
<p>* Lines 2..1+M: Line i+1 indicates the position from the top, P[i], of the i-th card in the Bessie-shuffle (1 &lt;= P[i] &lt;= M).</p>
<p>* Lines 2+M..1+M+Q: Line i+1+M contains a single integer q_i</p>
<p>describing the i-th query.  You are to compute the label on the card located in position q_i from the top (1 &lt;= q_i &lt;= N).</p>
<h2 id="_3">è¾“å‡ºæ ¼å¼</h2>
<p>* Lines 1..Q: On the i-th line, print a single integer indicating the card at position q_i from the top.</p>
<h2 id="_4">è¾“å…¥è¾“å‡ºæ ·ä¾‹</h2>
<h3 id="1">æ ·ä¾‹ #1</h3>
<h4 id="1_1">æ ·ä¾‹è¾“å…¥ #1</h4>
<pre class="codehilite"><code>5 3 5 
3 
1 
2 
1 
2 
3 
4 
5
</code></pre>

<h4 id="1_2">æ ·ä¾‹è¾“å‡º #1</h4>
<pre class="codehilite"><code>4 
5 
3 
1 
2
</code></pre>

<h2 id="_5">è¯´æ˜/æç¤º</h2>
<p>Bessie has a deck of 5 cards initially ordered as [1, 2, 3, 4, 5].  Her shuffle is on 3 cards and has the effect of moving the top card to the bottom.  There are 5 queries querying each position in the deck.</p>
<p>The shuffle proceeds as:</p>
<pre class="codehilite"><code class="language-cpp">[1, 2, 3, 4, 5] -&gt; [2, 3, 1, 4, 5] (put 2 face down) 
[3, 1, 4, 5] -&gt; [1, 4, 3, 5] (put 1 face down) 
[4, 3, 5] -&gt; [3, 5, 4] (put 3 face down) 
[5, 4] (put 5 face down) 
[4] (put 4 face down) 
</code></pre>

<p>This produces the final order of [4, 5, 3, 1, 2]</p>
              
              <!-- Giscusè¯„è®ºç³»ç»Ÿ -->
              <div class="comments-section">
                <div class="comments-title">
                  ğŸ’¬ è®¨è®ºäº¤æµ
                </div>
                <script src="https://giscus.app/client.js"
                        data-repo="Eternity-Sky/luogu-problem-reader"
                        data-repo-id="R_kgDOPiP5uw"
                        data-category="Announcements"
                        data-category-id="DIC_kwDOPiP5u84CugHo"
                        data-mapping="url"
                        data-strict="0"
                        data-reactions-enabled="1"
                        data-emit-metadata="0"
                        data-input-position="bottom"
                        data-theme="preferred_color_scheme"
                        data-lang="zh-CN"
                        data-loading="lazy"
                        crossorigin="anonymous"
                        async>
                </script>
              </div>
            </article>
          </div>
        </div>
      </main>
      <footer class="md-footer">
        <div class="md-footer-meta md-typeset">
          <div class="md-footer-meta__inner md-grid">
            <div class="md-copyright">
              <div class="md-copyright__highlight">Â© 2025 æ´›è°·é¢˜ç›®æµè§ˆç«™</div>
              Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">Material for MkDocs</a>
            </div>
          </div>
        </div>
      </footer>
    </div>
    <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
      if (typeof hljs !== 'undefined') {
        hljs.highlightAll();
      }
    </script>
    <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
    <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, { 
          delimiters: [
            {"left":"$$","right":"$$","display":true},
            {"left":"$","right":"$","display":false},
            {"left":"\\(","right":"\\)","display":false},
            {"left":"\\[","right":"\\]","display":true}
          ],
          throwOnError: false,
          strict: false,
          trust: true
        });
      });
    </script>
  </body>
</html>